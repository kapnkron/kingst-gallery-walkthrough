
<!DOCTYPE html>
<html>
<head>
    <title>King St. Gallery Virtual Walkthrough</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        html, body {{ margin: 0; height: 100%; overflow: hidden; }}
        #pano {{ width: 100%; height: 100%; }}
        .hotspot {{
            background: rgba(255,255,255,0.85);
            border-radius: 6px;
            padding: 5px 10px;
            cursor: pointer;
            font-weight: bold;
        }}
        .popup {{
            position: absolute;
            z-index: 10;
            background: white;
            color: black;
            padding: 15px;
            border: 2px solid #000;
            border-radius: 10px;
            display: none;
            max-width: 250px;
        }}
    </style>
</head>
<body>
<div id="pano"></div>
<div id="popup" class="popup"></div>

<script src="https://cdn.jsdelivr.net/npm/marzipano@0.10.1/dist/marzipano.js"></script>
<script>
    const viewer = new Marzipano.Viewer(document.getElementById("pano"));
    const source = Marzipano.ImageUrlSource.fromString("gallery.png");
    const geometry = new Marzipano.EquirectGeometry([{{ width: 4000 }}]);
    const limiter = Marzipano.RectilinearView.limit.traditional(1024, 100*Math.PI/180);
    const view = new Marzipano.RectilinearView(null, limiter);
    const scene = viewer.createScene({{ source, geometry, view, pinFirstLevel: true }});

    const popup = document.getElementById("popup");

    function showPopup(text, event) {{
        popup.innerHTML = text;
        popup.style.left = event.clientX + 'px';
        popup.style.top = event.clientY + 'px';
        popup.style.display = 'block';
    }}

    function hidePopup() {{
        popup.style.display = 'none';
    }}

    document.addEventListener('click', function(event) {{
        if (!event.target.classList.contains('hotspot')) {{
            hidePopup();
        }}
    }});

    const artworks = [
        {{ yaw: 0.2, pitch: 0.1, title: "In the City", artist: "Miguel Freitas" }},
        {{ yaw: 0.5, pitch: 0.0, title: "Venice at Night", artist: "Miguel Freitas" }},
        {{ yaw: 0.8, pitch: -0.1, title: "The Lonely Balcony", artist: "Miguel Freitas" }},
        {{ yaw: -0.2, pitch: 0.1, title: "Moonlight Flowers", artist: "Jordan Hicks" }},
        {{ yaw: -0.5, pitch: 0.0, title: "Another Great Day", artist: "Jordan Hicks" }},
        {{ yaw: -0.8, pitch: -0.1, title: "Endless Happiness", artist: "Jordan Hicks" }}
    ];

    artworks.forEach(art => {{
        const el = document.createElement('div');
        el.className = 'hotspot';
        el.innerText = art.title;
        el.addEventListener('click', (e) => {{
            showPopup(`<strong>${{art.title}}</strong><br>${{art.artist}}<br><em>Description of art</em>`, e);
        }});
        scene.hotspotContainer().createHotspot(el, {{ yaw: art.yaw, pitch: art.pitch }});
    }});

    scene.switchTo();
</script>
</body>
</html>
